# Unity 系統展示 - 連續技系統

連招系統是許多遊戲都會有的基本系統，它的特色是連按攻擊鍵就會做出不同動作的連續攻擊，例如真三國無雙。

本系統展示主要是讓玩家能夠在遊戲裡使用連續攻擊，按下空白鍵就能進行攻擊，而在前一段攻擊即將結束前再次按下空白鍵就能切換成下一段攻擊。

在連招系統的設計上，一般都是用判斷目前動畫影格或時間的方式來決定是否可以切換成下一招，而本系統是採用百分比的方式，例如當上一段攻擊執行到其75%時就可進入下一段攻擊。

原則上兩種判斷方式都可用，但由於本系統僅用於展示，所以沒有設計與傷害有關的判斷系統，不過程式裡有保留相關方法可供參考。

雖然本系統裡的連續攻擊只有兩段，但整套連招系統仍可以持續擴充，我已經把它設計成可以在遊戲編輯器裡直接拖曳每一段連招的程式碼並按照順序進行攻擊，你可以把它擴充到10段甚至100段。

#原理介紹

連續技系統要簡單可以很簡單，但要難也可以超級難，簡單的連招就好比真三國無雙那樣，連續按同一個按鍵就好。

比較難的就好比格鬥天王、快打旋風那樣，除了普通攻擊的連招外，還要判斷各種必殺技之間的連段。

若將連招系統拆開來看的話，則它的流程如下：

玩家按下攻擊鍵→判斷是否正在攻擊中→若不是，執行第一段攻擊，否則判斷是否已經可以進入下一段攻擊→若可以連段，那就進入下一個攻擊

判斷第一段攻擊可以設置一個 (int)AttackLevel 變數來偵測攻擊狀態，只要 AttackLevel==1 就進入第一段攻擊，AttackLevel==2 就進入第二段攻擊依此類推，直到任何一段攻擊結束並回到閒置狀態後才將 AttackLevel 設定成 0。

至於是否可以進入下一段連招則可以用動畫的播放進度來做判斷，若不做判斷的話那麼一旦玩家拚命連按攻擊就會讓連招斷掉。

在攻擊時也別忘了鎖住其他鍵盤動作，例如行走或跳躍，免得出現一邊攻擊一邊滑動的奇怪畫面。

整個連招系統大致上就是這樣，雖然這個連招系統可以用強制指定招式的方式寫死在程式碼裡，但這會讓後續擴充與維護變得不容易，若讓每一個連招都能獨立運作的話會簡單許多。

為了達到這個目的，我寫了一個 Abstract 讓往後的新招式都能繼承，凡是繼承 PlayerMovesAbstract 的程式碼都能被放到 AttackMoveList 裡。

而在執行連段時，連招系統就會呼叫 AttackMoveList[AttackLevel]，這樣一來只要增加 AttackLevel 就能自動呼叫下一個連段。

所有繼承 PlayerMovesAbstract 的類別都一定要有 PlayAttackAnimation() 以及 Attack() 這兩種方法，分別代表播放攻擊動畫＆傳遞攻擊傷害。

雖然本系統沒有做攻擊傷害，但要實作也不難，在 Attack() 裡面判斷攻擊動畫的播放進度並決定何時附上 Trigger 或 Collider 就可以了。

歡迎自行下載整份專案回去玩，分享或轉載請註明本來源。
